<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Música - Neogeo Portafolio</title>
    <link rel="stylesheet" href="styles.css">
    <script type="module" src="https://unpkg.com/@google/model-viewer/dist/model-viewer.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/wavesurfer.js/4.0.1/wavesurfer.min.js"></script>
    <style>
        /* Estilo adicional para el contenedor */
        .music-container {
            position: relative;
            text-align: center;
        }

        .music-player {
            margin-bottom: 10px;
            width: 20%;
            max-width: 250px;
            margin-left: auto;
            margin-right: auto;
            position: absolute;
            top: 300px;
            left: 50%;
            transform: translate(-50%, 0);
            z-index: 10; /* Asegúrate de que esté encima */
        }

        model-viewer {
            width: 100%;
            height: 500px;
            z-index: 9; /* El más bajo para el modelo 3D */
        }

        /* Estilo para la forma de onda */
        #waveform {
            width: 85%;
            height: 84px; /* Tamaño más pequeño */
            margin: 10px auto;
            position: absolute; /* Cambiado a absolute para que pueda moverse */
            top: 250px; /* Ajusta la posición desde arriba */
            left: 50%;
            transform: translateX(-50%);
            z-index: 1; /* Más alto que el modelo 3D, más bajo que el reproductor */
        }

        /* Estilos para el anuncio */
        .announcement-banner {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background-color: rgba(0, 0, 0, 0.7);
            color: white;
            text-align: center;
            padding: 10px;
            font-size: 16px;
            z-index: 100;
            animation: randomColors 5s linear infinite;
        }

        .announcement-banner marquee {
            font-weight: bold;
        }

        @keyframes randomColors {
            0% { background-color: #FF5733; }
            20% { background-color: #FFBD33; }
            40% { background-color: #DBFF33; }
            60% { background-color: #75FF33; }
            80% { background-color: #33FF57; }
            100% { background-color: #33FFBD; }
        }

        /* Estilo para la imagen de la mano */
        .hand-image {
            position: absolute;
            left: 10px; /* Ajusta según sea necesario */
            top: 350px; /* Ajusta según sea necesario */
            width: 400px; /* Ajusta el tamaño según sea necesario */
            cursor: pointer; /* Indica que la imagen es arrastrable */
            z-index: 20; /* Asegúrate de que esté encima del modelo 3D */
        }

        /* Estilo para los reproductores de SoundCloud */
        .soundcloud-player {
            width: 200px; /* Ancho del reproductor */
            height: 200px; /* Alto del reproductor */
            border: 1px solid #ccc; /* Borde para visualizar mejor */
            margin: 10px;
            cursor: move; /* Indica que se pueden arrastrar */
        }
    </style>
</head>
<body>
    <!-- Cartel de anuncio -->
    <div class="announcement-banner">
        <marquee behavior="scroll" direction="left">¡Interactúa con el modelo 3D y controla el reproductor de música!</marquee>
    </div>

    <header>
        <div class="nav-toggle" id="nav-toggle">
            <span>☰</span>
        </div>
        <nav class="nav-content" id="nav-content">
            <a href="index.html">Inicio</a>
            <a href="projects.html">Proyectos</a>
            <a href="media.html">Medios</a>
            <a href="music.html">Música</a>
            <a href="visuals.html">Visuales</a>
        </nav>
    </header>

    <main>
        <section class="music-container">
            <div class="music-player">
                <audio id="audio-player" controls>
                    <source src="micancion.mp3" type="audio/mpeg">
                    Tu navegador no soporta el reproductor de audio.
                </audio>
            </div>
     
            <model-viewer  
                src="cdj.glb" 
                alt="DJ Mixer" 
                camera-controls 
                auto-rotate 
                ar>
            </model-viewer>

            <div id="waveform"></div> <!-- Contenedor para la forma de onda -->

            <div class="soundcloud-players">
                <iframe class="soundcloud-player" scrolling="no" frameborder="no" allow="autoplay" 
                    src="https://w.soundcloud.com/player/?url=https%3A//api.soundcloud.com/tracks/1295655508&color=%23ff5500&auto_play=false&hide_related=false&show_comments=true&show_user=true&show_reposts=false&show_teaser=true&visual=true"></iframe>
                <iframe class="soundcloud-player" scrolling="no" frameborder="no" allow="autoplay" 
                    src="https%3A//api.soundcloud.com/tracks/1295655508&color=%23ff5500&auto_play=false&hide_related=false&show_comments=true&show_user=true&show_reposts=false&show_teaser=true&visual=true"></iframe>
                <iframe class="soundcloud-player" scrolling="no" frameborder="no" allow="autoplay" 
                    src="https%3A//api.soundcloud.com/tracks/1295655508&color=%23ff5500&auto_play=false&hide_related=false&show_comments=true&show_user=true&show_reposts=false&show_teaser=true&visual=true"></iframe>
                <iframe class="soundcloud-player" scrolling="no" frameborder="no" allow="autoplay" 
                    src="https%3A//api.soundcloud.com/tracks/1295655508&color=%23ff5500&auto_play=false&hide_related=false&show_comments=true&show_user=true&show_reposts=false&show_teaser=true&visual=true"></iframe>
            </div>

            <!-- Imagen de la mano -->
            <img src="manoizq.png" class="hand-image" id="hand-image" alt="Mano Izquierda">
        </section>
    </main>

    <footer>
        <p>&copy; 2024 Neogeo - Todos los derechos reservados</p>
    </footer>

    <script>
        document.getElementById('nav-toggle').addEventListener('click', function() {
            const navContent = document.getElementById('nav-content');
            navContent.classList.toggle('open');
        });

        const modelViewer = document.querySelector('model-viewer');

        // Permitir arrastrar el modelo
        modelViewer.addEventListener('mousedown', (event) => {
            event.preventDefault();
            const startX = event.clientX;
            const startY = event.clientY;

            const onMouseMove = (moveEvent) => {
                const deltaX = moveEvent.clientX - startX;
                const deltaY = moveEvent.clientY - startY;

                const rotationY = modelViewer.getAttribute('rotation').split(' ')[1];
                modelViewer.setAttribute('rotation', `${modelViewer.getAttribute('rotation').split(' ')[0]} ${Number(rotationY) - deltaX / 2} ${modelViewer.getAttribute('rotation').split(' ')[2]}`);

                const rotationX = modelViewer.getAttribute('rotation').split(' ')[0];
                modelViewer.setAttribute('rotation', `${Number(rotationX) + deltaY / 2} ${rotationY} ${modelViewer.getAttribute('rotation').split(' ')[2]}`);
            };

            const onMouseUp = () => {
                window.removeEventListener('mousemove', onMouseMove);
                window.removeEventListener('mouseup', onMouseUp);
            };

            window.addEventListener('mousemove', onMouseMove);
            window.addEventListener('mouseup', onMouseUp);
        });

        // Permitir arrastrar la imagen de la mano
        const handImage = document.getElementById('hand-image');

        handImage.addEventListener('mousedown', (event) => {
            event.preventDefault();
            const startX = event.clientX;
            const startY = event.clientY;
            const initialLeft = handImage.offsetLeft;
            const initialTop = handImage.offsetTop;

            const onMouseMove = (moveEvent) => {
                const deltaX = moveEvent.clientX - startX;
                const deltaY = moveEvent.clientY - startY;
                handImage.style.left = `${initialLeft + deltaX}px`;
                handImage.style.top = `${initialTop + deltaY}px`;
            };

            const onMouseUp = () => {
                window.removeEventListener('mousemove', onMouseMove);
                window.removeEventListener('mouseup', onMouseUp);
            };

            window.addEventListener('mousemove', onMouseMove);
            window.addEventListener('mouseup', onMouseUp);
        });

        // Configuración de Wavesurfer.js para la forma de onda
        const audioPlayer = document.getElementById('audio-player');
        const waveformContainer = document.getElementById('waveform');
        const wavesurfer = WaveSurfer.create({
            container: waveformContainer,
            waveColor: 'purple',
            progressColor: 'orange',
            height: 64,
            barWidth: 2,
        });

        audioPlayer.addEventListener('play', () => {
            wavesurfer.load(audioPlayer.src);
            wavesurfer.play();
        });

        audioPlayer.addEventListener('pause', () => {
            wavesurfer.pause();
        });

        audioPlayer.addEventListener('timeupdate', () => {
            wavesurfer.setCurrentTime(audioPlayer.currentTime);
        });

        wavesurfer.on('seek', (progress) => {
            audioPlayer.currentTime = wavesurfer.getCurrentTime();
        });
    </script>
</body>
</html>
